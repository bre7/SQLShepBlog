# + lg_PerCapitaPI
# + lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
#+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
#+ lg_Inactivity
#+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
#+ lg_Inactivity
#+ lg_Obesity
#+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
#+ lg_Inactivity
#+ lg_Obesity
#+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
#+ lg_Inactivity
#+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
#+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
summary(elect_lg.glm)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
#+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
#+ lg_HHMedianIncome
#+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
+ lg_HHMedianIncome
#+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
summary(data.Main$lg_HHMedianIncome)
data.Main$lg_HHMedianIncome
setwd("/Users/Shep/Harvard DS/Stat 150/Project/Data")
getwd()
data.Main <- read.csv("USA.dataAll.csv",stringsAsFactors=FALSE,header=TRUE)
install.packages("car")
install.packages("car")
library(car)
is.na(data.Main )
[!(is.na(data.Main))]
[!(is.na(data.Main)]
!(is.na(data.Main)
!(is.na(data.Main))
!(is.na(data.Main))
data.Main[(is.na(data.Main))]
data.Main[is.na(data.Main)] <-0
is.na(data.Main)
ggplot(data=data.Main, aes(Population)) +
geom_histogram(aes(fill=..count..))
elect.glm <- glm(Winner~Population + PovertyPercent +
EDU_LessHSDiploma + EDU_HSDiploma + EDU_SomeCollegeorAS + EDU_BSorHigher
+ UnemploymentRate + Married + Divorced + GINI_Coeff + HHMedianIncome + HHMeanIncome
+ PerCapitaPI + Diabetes + Inactivity + Obesity + Uninsured + OpiodRx + USDANaturalAmenityRank
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
summary(elect.glm)
setwd("/Users/Shep/Harvard DS/Stat 150/Project/Data")
getwd()
data.Main <- read.csv("USA.dataAll.csv",stringsAsFactors=FALSE,header=TRUE)
#install.packages("car")
library(car)
#install.packages("choroplethr")
#install.packages("choroplethrMaps")
library(choroplethr)
library(choroplethrMaps)
#remove all NAs
data.Main[is.na(data.Main)] <-0
data.Main <- data.Main[!(data.Main$X == "1864"),]
names(data.Main[1:26])
# [1] "Population"              "Poverty"                 "PovertyPercent"          "EDU_LessHSDiploma"       "EDU_HSDiploma"
# [6] "EDU_SomeCollegeorAS"     "EDU_BSorHigher"          "UnemploymentRate"        "Married"                 "Divorced"
# [11] "GINI_Coeff"              "HHMedianIncome"          "HHMeanIncome"            "PerCapitaPI"             "Diabetes"
# [16] "Inactivity"              "Obesity"                 "Uninsured"               "OpiodRx"                 "USDANaturalAmenityScale"
# [21] "USDANaturalAmenityRank"
#cor(data.Main[6:26])
#write.csv(x, file="cor.csv")
options(scipen=999)
ggplot(data=data.Main, aes(Population)) +
geom_histogram(aes(fill=..count..))
elect.glm <- glm(Winner~Population + PovertyPercent +
EDU_LessHSDiploma + EDU_HSDiploma + EDU_SomeCollegeorAS + EDU_BSorHigher
+ UnemploymentRate + Married + Divorced + GINI_Coeff + HHMedianIncome + HHMeanIncome
+ PerCapitaPI + Diabetes + Inactivity + Obesity + Uninsured + OpiodRx + USDANaturalAmenityRank
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
summary(elect.glm)
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
+ lg_HHMedianIncome
+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
#+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
data.Main[is.infinite(data.Main)]
is.na(data.Main) <- sapply(data.Main, is.infinite)
data.Main[is.na(data.Main)] <-0
elect_lg.glm <- glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma
+ lg_EDU_HSDiploma
+ lg_EDU_SomeCollegeorAS
+ lg_EDU_BSorHigher
+ lg_UnemploymentRate
+ lg_Married
+ lg_Divorced
+ lg_GINI_Coeff
+ lg_HHMedianIncome
+ lg_HHMeanIncome
+ lg_PerCapitaPI
+ lg_Diabetes
+ lg_Inactivity
+ lg_Obesity
+ lg_Uninsured
+ lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
summary(elect_lg.glm)
elect_lg.glm.back <- step(glm(Winner~lg_Population + lg_PovertyPercent
+ lg_EDU_LessHSDiploma + lg_EDU_HSDiploma + lg_EDU_SomeCollegeorAS + lg_EDU_BSorHigher
+ lg_UnemploymentRate + lg_Married + lg_Divorced + lg_GINI_Coeff + lg_HHMedianIncome + lg_HHMeanIncome
+ lg_PerCapitaPI + lg_Diabetes + lg_Inactivity + lg_Obesity + lg_Uninsured + lg_OpioidRx
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial), direction = "backward")
summary(elect_lg.glm.back)
elect_lg.glm <- glm(formula = Winner ~ lg_Population + lg_PovertyPercent + lg_EDU_HSDiploma +
lg_EDU_SomeCollegeorAS + lg_EDU_BSorHigher + lg_UnemploymentRate +
lg_Married + lg_HHMeanIncome + lg_Diabetes + lg_Inactivity +
lg_OpioidRx family = binomial, data = data.Main)
summary(elect_lg.glm.back)
elect_lg.glm <- glm(formula = Winner ~ lg_Population + lg_PovertyPercent + lg_EDU_HSDiploma +
lg_EDU_SomeCollegeorAS + lg_EDU_BSorHigher + lg_UnemploymentRate +
lg_Married + lg_HHMeanIncome + lg_Diabetes + lg_Inactivity +
lg_OpioidRx family = binomial, data = data.Main)
summary(elect_lg.glm)
elect_lg.glm <- glm(formula = Winner ~ lg_Population + lg_PovertyPercent + lg_EDU_HSDiploma +
lg_EDU_SomeCollegeorAS + lg_EDU_BSorHigher + lg_UnemploymentRate +
lg_Married + lg_HHMeanIncome + lg_Diabetes + lg_Inactivity +
lg_OpioidRx family = binomial, data = data.Main)
elect_lg.glm <- glm(Winner ~ lg_Population + lg_PovertyPercent + lg_EDU_HSDiploma +
lg_EDU_SomeCollegeorAS + lg_EDU_BSorHigher + lg_UnemploymentRate +
lg_Married + lg_HHMeanIncome + lg_Diabetes + lg_Inactivity +
lg_OpioidRx, family = binomial, data = data.Main)
summary(elect_lg.glm)
names(data.Main[27:54])
names(data.Main[34:54])
names(data.Main[35:54])
names(data.Main[35:53])
setwd("/Users/Shep/Harvard DS/Stat 150/Project/Data")
getwd()
data.Main <- read.csv("USA.dataAll.csv",stringsAsFactors=FALSE,header=TRUE)
#install.packages("car")
library(car)
#install.packages("choroplethr")
#install.packages("choroplethrMaps")
library(choroplethr)
library(choroplethrMaps)
#remove all NAs and infinites
is.na(data.Main) <- sapply(data.Main, is.infinite)
data.Main[is.na(data.Main)] <-0
data.Main <- data.Main[!(data.Main$X == "1864"),]
ggplot(data=data.Main, aes(Population)) +
geom_histogram(aes(fill=..count..))
elect.glm <- glm(Winner~Population + PovertyPercent +
EDU_LessHSDiploma + EDU_HSDiploma + EDU_SomeCollegeorAS + EDU_BSorHigher
+ UnemploymentRate + Married + Divorced + GINI_Coeff + HHMedianIncome + HHMeanIncome
+ PerCapitaPI + Diabetes + Inactivity + Obesity + Uninsured + OpiodRx + USDANaturalAmenityRank
+ RUC_1 + RUC_2 + RUC_3 + RUC_4 + RUC_5 + RUC_6 + RUC_7 + RUC_8
,data=data.Main,  family=binomial)
elect_lg.glm <- glm(Winner ~ lg_Population + lg_PovertyPercent + lg_EDU_HSDiploma +
lg_EDU_SomeCollegeorAS + lg_EDU_BSorHigher + lg_UnemploymentRate +
lg_Married + lg_HHMeanIncome + lg_Diabetes + lg_Inactivity +
lg_OpioidRx, family = binomial, data = data.Main)
summary(elect_lg.glm)
plot(elect_lg.glm)
plot(elect_lg.glm)
summary(elect_lg.glm)
confint(elect_lg.glm.back)
confint(elect_lg.glm)
fit # show results
# Linear Discriminant Analysis with Jacknifed Prediction
library(MASS)
fit <- lda(G ~ x1 + x2 + x3, data=mydata,
na.action="na.omit", CV=TRUE)
fit # show results
# Linear Discriminant Analysis with Jacknifed Prediction
library(MASS)
fit <- lda(G ~ x1 + x2 + x3, data=mydata,
na.action="na.omit", CV=TRUE)
fit <- lda(G ~ x1 + x2 + x3, data=mydata,
na.action="na.omit", CV=TRUE)
data(MASS)
library(MASS)
data(MASS)
data(package="MASS")
library(dplyr)
library(ggplot2)
library(GGally)
# Set working dir if you download this locally
# getwd()
setwd("/Users/Shep/git/SQLShepBlog/data")
epa <- read.csv("18tstcar.csv",stringsAsFactors=FALSE)
View(epa)
View(epa)
names(epa)[12] <-paste("Cylinders")
names(epa)[46] <-paste("FuelEcon")
colnames(epa)[colnames(epa)=="X..of.Gears"] <- "Gears"
colnames(epa)[colnames(epa)=="Axle.Ratio"] <- "AxleRatio"
epa <- dplyr::rename(epa, HorsePower = "Rated.Horsepower")
epa <- dplyr::rename(epa, Weight = "Equivalent.Test.Weight..lbs..")
epa <- dplyr::rename(epa, Model = "Represented.Test.Veh.Model")
# now that we have a much larger dataset we can do a few visualizations to confirm some prior hypothesis.
ggplot(epa,aes(FuelEcon,Weight))+
geom_point()
filter(epa,   FuelEcon > 9000)
epa[epa$Test.Vehicle.ID == "184HV863DA" ,]
epa[epa$Test.Vehicle.ID == "184HV863DA" ,c("Represented.Test.Veh.Make","Model","Test.Vehicle.ID","FuelEcon")]
summary(epa$Vehicle.Type)
summary(as.factor(epa$Vehicle.Type))
